<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=pragma content="no-cache"><meta http-equiv=cache-control content="no-cache"><meta name=author content="Sanoon"><meta name=description content="Apache Kafka 是一个开放源代码的分布式流处理平台，越来越多的公司使用它来实现高性能数据管道、流分析、数据集成和关键任务的应用程序。"><meta name=keywords content="Kafka,Topic,Producer,Consumer,Streams,Connector,分布式"><link rel=canonical href=https://sanoon.me/posts/kafka-%E5%85%A5%E9%97%A8/><title>Kafka 入门 | Sanoon with Lemon - Java, Go, Python, SpringBoot, Spring Cloud, Docker, Vue</title><link rel="shortcut icon" href=https://sanoon.me/images/favicon.ico><link rel=stylesheet href=https://sanoon.me/css/animate.min.css><link rel=stylesheet href=https://sanoon.me/css/remixicon.css><link rel=stylesheet href=https://sanoon.me/css/zozo.css><link rel=stylesheet href=https://sanoon.me/css/highlight.css></head><body><div class="main animated"><div class="nav_container animated fadeInDown"><div class=site_nav id=site_nav><ul><li><a href=/>首页</a></li><li><a href=/posts/>归档</a></li><li><a href=/photo/>摄影</a></li><li><a href=/tags/>标签</a></li><li><a href=/about/>关于</a></li></ul></div><div class=menu_icon><a id=menu_icon><i class=remixicon-links-line></i></a></div></div><div class="header animated fadeInDown"><div class=site_title_container><div class=site_title><h1><a href=https://sanoon.me><span>Sanoon with Lemon</span>
<img src=https://cdn.jsdelivr.net/gh/scopor/cdn@1.0.3/logos.svg style=margin-top:-8px></a></h1></div><div class=description><p class=sub_title>Life with teacher Lemon.</p><div class=my_socials><a href=https://book.douban.com/people/lingluoyanchen/collect title=book target=_blank><i class=remixicon-book-fill></i></a><a href=https://sanoon.me/photo/ title=camera target=_blank><i class=remixicon-camera-fill></i></a><a href=https://github.com/scopor title=github target=_blank><i class=remixicon-github-fill></i></a><a href=https://movie.douban.com/people/lingluoyanchen/collect title=movie target=_blank><i class=remixicon-movie-fill></i></a><a href="https://music.163.com/#/my/m/music/playlist?id=97552201" title=music target=_blank><i class=remixicon-music-fill></i></a><a href=https://twitter.com/DesperadoYan title=twitter target=_blank><i class=remixicon-twitter-fill></i></a><a href=https://sanoon.me/index.xml type=application/rss+xml title=rss target=_blank><i class=remixicon-rss-fill></i></a></div></div></div></div><div class=content><div class=post_page><div class="post animated fadeInDown"><div class="post_title post_detail_title"><h2><a href=/posts/kafka-%E5%85%A5%E9%97%A8/>Kafka 入门</a></h2><span class=date>2020.08.13</span></div><div class="post_content markdown"><h2 id=概述>概述</h2><ul><li><p>定义</p><ul><li><code>Kafka</code> 是一个分布式流处理框架。</li></ul></li><li><p>特性</p><ul><li>实现消息的发布/订阅</li><li>存储流消息</li><li>实时流处理</li></ul></li><li><p>核心 API</p><ul><li>The Producer API：允许生产者发布消息到一个或者多个 <code>TOPIC</code></li><li>The Consumer API：允许消费者消费一个或者多个 <code>TOPIC</code>，并对接收到的消息进行处理</li><li>The Streams API：允许应用程序作为一个<code>流处理器</code>，消费一个或者多个<code>TOPIC</code>产生的输入流，然后生辰一个新的输出流到一个或者多个<code>TOPIC</code>中去。</li><li>The Connector API：允许构建并运行可重用的生产者或者消费者，将<code>Kafka topics</code>连接到已存在的用用程序或者数据系统上。例如连接到关系型数据库，捕捉表的变更。</li></ul></li><li><p>协议</p><ul><li><code>TCP</code></li></ul></li><li><p>TOPIC</p><ul><li><code>TOPIC</code>是数据记录的主题，多订阅模式，每个<code>TOPIC</code>有一到多个消费者。</li><li>每个<code>TOPIC</code>就会有一个分区日志，每个分区都是有序不可变的记录集，每条记录都会分配一个 ID 来表示顺序，即 <code>offset</code>，用来唯一区分每一条记录。</li><li><code>Kafka</code> 集群会保留所有发布的消息记录，可以通过保留期的可配置参数来控制消息保留多久。</li><li><code>offset</code>，消费者唯一保存的元数据就是偏移量 <code>offset</code>，消费者读取消息后限行增加偏移量，消费者可以重置偏移量，读取之前的数据进行重新处理</li></ul></li><li><p>分区</p><ul><li>日志的分区分布在<code>Kafa</code>集群上，每个服务器在处理数据和请求时，共享分区。每个分区都有备份，确保容错性。</li><li>每个分区都有 1 台服务器作为<code>Leader</code>，0 到 N 台服务器作为<code>Followers</code>，<code>Leader</code> 负责对分区的读写请求，<code>Followers</code>只需同步<code>Leader</code>的数据，当<code>Leader</code> 宕机，其中 1 个<code>Followers</code>会成为新的<code>Leader</code>，每台服务器都会成为某些分区的<code>Leader</code>或者<code>Followers</code>，因此集群的负责可以保持平衡。</li></ul></li><li><p>生产者</p><ul><li>生产者负责将消息记录分配到<code>TOPIC</code>的某个分区中，可以使用循环的方式实现负载均衡，也可以根据某些语义分区函数来完成，例如设置消息记录的<code>Key</code>。</li></ul></li><li><p>消费者</p><ul><li>消费者使用一个 消费组 来进行标识区分，消息记录被分配给订阅消费组的其中一个消费者实例，消费者实例可以分布在不同的进程上</li><li>如果所有的消费者实例在同一个消费组，消息记录会负载平衡到每一个消费者实例</li><li>如果消费者实例分布在不同的消费组，每条消息记录会广播到所有的消费者进程</li><li>消费组的消费者新增或者移除，由<code>Kafka</code>协议动态处理</li><li>每个消费者实例都是某个分区的唯一消费者</li></ul></li></ul></div><div class=post_footer><div class=meta><div class=info><span class="field tags"><i class=remixicon-stack-line></i><a href=https://sanoon.me/tags/kafka/>Kafka</a>
<a href=https://sanoon.me/tags/topic/>Topic</a>
<a href=https://sanoon.me/tags/producer/>Producer</a>
<a href=https://sanoon.me/tags/consumer/>Consumer</a>
<a href=https://sanoon.me/tags/streams/>Streams</a>
<a href=https://sanoon.me/tags/connector/>Connector</a>
<a href=https://sanoon.me/tags/%E5%88%86%E5%B8%83%E5%BC%8F/>分布式</a>
<span id=busuanzi_container_page_pv>view <span id=busuanzi_value_page_pv></span>times</span></span></div></div></div></div></div></div><a id=back_to_top href=# class=back_to_top><span>△</span></a></div><footer class=footer><div class=powered_by><a href=https://zeuk.me>Designed by Zeuk,</a>
<a href=http://www.gohugo.io/>Proudly published with Hugo</a></div><div class=footer_slogan><span>时间改变了很多也什么都没有, 让我再次拥抱你废都.</span></div><div class=footer_slogan style=margin-top:-10px><span id=busuanzi_container_site_pv>本站总访问量 <span id=busuanzi_value_site_pv></span>次</span></div></footer><script src=https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js></script><script src=https://cdn.jsdelivr.net/gh/scopor/cdn@1.1.3/zozo.js></script><script src=https://cdn.jsdelivr.net/gh/scopor/cdn@1.1.3/highlight.pack.js></script><link href=https://cdn.jsdelivr.net/gh/scopor/cdn@1.1.1/fancybox.min.css rel=stylesheet><script src=https://cdn.jsdelivr.net/gh/scopor/cdn@1.1.3/fancybox.min.js></script><script>hljs.initHighlightingOnLoad()</script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\[\[','\]\]']],processEscapes:true,processEnvironments:true,skipTags:['script','noscript','style','textarea','pre'],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}});MathJax.Hub.Queue(function(){var all=MathJax.Hub.getAllJax(),i;for(i=0;i<all.length;i+=1){all[i].SourceElement().parentNode.className+=' has-jax';}});</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-163559575-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>